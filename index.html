<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <title>DOM 塔防卡 - 纯前端牌类塔防游戏</title>
    <!--
      运行说明：
      - 直接用浏览器打开本文件（双击或拖入浏览器）即可游玩，无需任何后端。
      - 也可以使用任意静态服务器（如 `npx serve`）以 http 方式打开。

      文件结构概览：
      - index.html        入口页面
      - styles.css        全局样式与游戏视觉
      - src/main.js       入口脚本，初始化游戏
      - src/game/config.js   基础配置（波次、数值等）
      - src/game/cards.js    卡牌配置与相关工具
      - src/game/ui.js       UI 缓存与更新、按钮与手牌渲染
      - src/game/tower.js    塔的创建与样式卡应用
      - src/game/enemy.js    敌人创建与行为更新
      - src/game/game.js     核心游戏循环与状态管理
      - src/game/storage.js  localStorage 存档（最高波数等）

      扩展方向：
      - 想增加新塔/敌人：在 config.js 与 tower.js / enemy.js 中添加配置与行为。
      - 想增加新卡牌：在 cards.js 中添加 Card 配置，并在游戏中使用。
      - 想调整数值平衡：修改 config.js 中的基础数值与 waveConfigs。
    -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <div id="game-root">
      <!-- 开始游戏覆盖层 -->
      <div id="start-screen" class="overlay">
        <div class="overlay-content">
          <h1>DOM 塔防卡</h1>
          <p>纯前端牌类塔防游戏，使用各种 DOM 塔防御网页怪物攻入基地！</p>
          <ul class="rule-list">
            <li>点击手牌进入使用模式。</li>
            <li>塔卡：在战场点击放置塔。</li>
            <li>布局卡 / 样式卡：点击已有塔或战场区域生效。</li>
            <li>撑过所有波次，守住基地即可胜利。</li>
          </ul>
          <div id="level-select" class="level-select">
            <p style="margin: 8px 0 4px 0; font-size: 13px; opacity: 0.9;">選擇關卡：</p>
            <!-- 關卡按鈕將由 JS 動態生成 -->
          </div>
          <button id="btn-start">开始游戏</button>
        </div>
      </div>

      <!-- 胜利覆盖层 -->
      <div id="victory-screen" class="overlay hidden">
        <div class="overlay-content">
          <h2>胜利！</h2>
          <p>你成功守住了 DOM 世界。</p>
          <p id="victory-best-record"></p>
          <button id="btn-restart-victory">再来一局</button>
        </div>
      </div>

      <!-- 失败覆盖层 -->
      <div id="defeat-screen" class="overlay hidden">
        <div class="overlay-content">
          <h2>失败...</h2>
          <p>网页怪物攻陷了你的基地。</p>
          <p id="defeat-best-record"></p>
          <button id="btn-restart-defeat">重试本关</button>
          <button id="btn-back-to-start-defeat">返回开始界面</button>
        </div>
      </div>

      <!-- 关卡完成覆盖层 -->
      <div id="level-complete-screen" class="overlay hidden">
        <div class="overlay-content">
          <h2 id="level-complete-title">关卡完成！</h2>
          <p id="level-complete-stats">擊殺敵人：0 / 0</p>
          <button id="btn-next-level">下一关</button>
          <button id="btn-retry-level">重玩本关</button>
        </div>
      </div>

      <!-- 关卡开始介绍气泡 -->
      <div id="level-intro-bubble" class="bubble hidden">
        <div class="bubble-content">
          <h2 id="bubble-level-title">第 1 关 · 入门训练</h2>
          <div id="bubble-difficulty" class="bubble-row">
            <span class="bubble-label">难度：</span>
            <span id="bubble-difficulty-stars" class="bubble-stars">★★☆☆☆</span>
          </div>
          <div id="bubble-enemy-types" class="bubble-row">
            <span class="bubble-label">敌人：</span>
            <span id="bubble-enemy-types-list"></span>
          </div>
          <div id="bubble-prep-time-row" class="bubble-row">
            <span class="bubble-label">布置时间：</span>
            <span id="bubble-prep-time" class="bubble-prep-time-value">10s</span>
          </div>
          <p id="bubble-description">敌人从顶部两侧进攻，尝试用 DIV 塔守住正面。</p>
          <div id="bubble-recommended" class="bubble-recommended">推荐多放 DIV 塔防守正面</div>
          <button id="btn-close-bubble">开始战斗</button>
        </div>
      </div>

      <!-- 主游戏布局 -->
      <div id="game-layout">
        <div id="game-field-wrapper">
          <div id="game-field">
            <!-- 基地 -->
            <div id="base">BASE</div>
          </div>
        </div>

        <div id="ui-panel">
          <div id="top-stats" class="status-bar">
            <!-- 左块：生存状态 -->
            <div class="status-block status-block--left">
              <div class="stat-item">
                <span class="stat-icon">🏰</span>
                <span class="stat-label">基地生命：</span>
                <div class="bar-container">
                  <div id="hp-bar" class="bar-fill"></div>
                </div>
                <span id="hp-text" class="stat-value">0 / 0</span>
              </div>
              <div class="stat-item">
                <span class="stat-icon energy-icon">⚡</span>
                <span class="stat-label">能量：</span>
                <div class="bar-container">
                  <div id="energy-bar" class="bar-fill energy"></div>
                </div>
                <span id="energy-text" class="stat-value">0 / 0</span>
              </div>
            </div>
            
            <!-- 中块：战局进度（核心信息） -->
            <div class="status-block status-block--center">
              <div id="battle-progress" class="battle-progress">
                <div class="battle-progress-main">
                  <span id="level-text" class="battle-level">Level 1 · 入門訓練</span>
                </div>
                <div class="battle-progress-details">
                  <span class="battle-detail-item">
                    波次 <span id="wave-text" class="battle-wave">1 / 2</span>
                  </span>
                  <span class="battle-detail-separator">|</span>
                  <span class="battle-detail-item">
                    敌人 <span id="enemy-progress-text" class="battle-enemies">0 / 14</span>
                  </span>
                </div>
              </div>
            </div>
            
            <!-- 右块：控制按钮 -->
            <div class="status-block status-block--right">
              <div class="stat-item stat-item--best">
                <span class="best-wave-label">Best Wave</span>
                <span id="best-record-text" class="best-wave-value">-</span>
              </div>
              <div class="stat-controls">
                <button id="btn-pause" class="btn-control">暂停</button>
                <button id="btn-speed" class="btn-control">1x</button>
                <button id="btn-debug" class="btn-control">调试</button>
                <button id="btn-back-to-menu" class="btn-control btn-control--menu">主菜单</button>
              </div>
            </div>
          </div>
          
          <!-- 增益信息（独立显示） -->
          <div class="stat-item" id="active-buffs-container" style="display: none;">
            <span>增益：</span>
            <span id="active-buffs-text"></span>
          </div>

          <div id="hand-panel">
            <h3>手牌</h3>
            <div id="hand-cards"></div>
          </div>
        </div>
      </div>
    </div>

    <script type="module" src="./src/main.js"></script>
  </body>
</html>


